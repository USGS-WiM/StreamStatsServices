#------------------------------------------------------------------------------
#----- Feature.py ----------------------------------------------------
#------------------------------------------------------------------------------

#-------1---------2---------3---------4---------5---------6---------7---------8
#       01234567890123456789012345678901234567890123456789012345678901234567890
#-------+---------+---------+---------+---------+---------+---------+---------+

# copyright:   2014 WiM - USGS

#    authors:  Jeremy K. Newson USGS Wisconsin Internet Mapping
# 
#   purpose:  GlobalDelineation <STABBR> <PourPoint> <GlobalWatershedPoint> <GlobalWatershed>
#          
#discussion:  Adapted from John Guthrie's GetGW12.py Global delineation script
#       

#region "Comments"
#06.01.2015 jkn - Created/ Adapted from John Guthrie's getDerivedFeats.py
#endregion

#region "Imports"
import sys
import traceback
import datetime
import os
import argparse
import arcpy
import shutil
import json
#import arcpy.cartography as CA
import logging

#endregion

class Features(object):
    #region Constructor
    def __init__(self, directory, workspaceid):
        
        self.Features = []        
        self.FeaturesList=[]
        self.Message =""


        self.WorkspaceID = workspaceid
        self.__MainDirectory__ = os.path.join(directory,self.WorkspaceID)

        #set up logging
        logdir = os.path.join(self.__MainDirectory__, 'Feature.log')
        logging.basicConfig(filename=logdir, format ='%(asctime)s %(message)s', level=logging.DEBUG)

         #Test if workspace exists before run   
        if(not self.__workspaceExists__(os.path.join(self.__MainDirectory__, self.WorkspaceID+".gdb","Layers"))):   
            self.__sm__("workspace: "+ os.path.join(self.__MainDirectory__, self.WorkspaceID+".gdb","Layers") + " does not exist", "ERROR")
            return
         
        arcpy.env.workspace =  os.path.join(self.__MainDirectory__, self.WorkspaceID+".gdb","Layers")
        self.__sm__("Initialized")

        self.__getFeaturesList__()
                 
    #endregion   
        
    #region Methods   
   
    def GetFeatures(self, featurelist=''):
        
        try:
            if featurelist == '':
                for fname in self.FeaturesList:
                    self.Features.append({"name" : fname})
                return

            else:
                for f in map(lambda s: s.strip(), featurelist.split(';')):
                    if f.lower() in self.FeaturesList:
                        self.Features.append({
                                                "name" : f,                                  
                                                "feature": self.__ToJSON__(f)
                                              })
        except:
            tb = traceback.format_exc()
            self.__sm__("Failed to include feature " + tb,"ERROR") 
   
    #endregion  
      
    #region Helper Methods
    def __workspaceExists__(self, workspace):
         return arcpy.Exists(workspace)

    def __getFeaturesList__(self):
        try:           
            #open feature/ loop through and add to array
            for fc in arcpy.ListFeatureClasses():
                self.FeaturesList.append(fc.lower())  
        except:
            tb = traceback.format_exc()
            self.__sm__("Featurelist Error "+tb,"ERROR")
         
    def __ToJSON__(self, fClass):
        featSet = None
        try:
            featSet = arcpy.FeatureSet()
            featSet.load(fClass)
            jsonStr = arcpy.Describe(featSet).json

            return json.loads(jsonStr)
        except:
            tb = traceback.format_exc()
            self.__sm__("Failed to serialize " + tb,"ERROR")

    def __sm__(self, msg, type = 'INFO'):
        self.Message += type +':' + msg.replace('_',' ') + '_'

        if type in ('ERROR'): logging.error(msg)
        else : logging.info(msg)
    #endregion


##-------1---------2---------3---------4---------5---------6---------7---------8
##       Main
##-------+---------+---------+---------+---------+---------+---------+---------+
class FeaturesWrapper(object):
    #region Constructor
    def __init__(self):
        try:
            parser = argparse.ArgumentParser()
            parser.add_argument("-workspaceID", help="specifies the working folder", type=str, default="IA20150824142145687000")
            parser.add_argument("-directory", help="specifies the projects working directory", type=str, default = r"D:\gistemp\ClientData")              
            parser.add_argument("-includefeatures", help="specifies the features", type=str, default = r"")
            parser.add_argument("-simplification", help="specifies the simplify method to, 1 = full, 2 = simplified", type=int, choices=[1,2], default = 2)
            parser.add_argument("-outputcrs", help="specifies the output projection to use",type=int, default=4326)           
            args = parser.parse_args()

            
            Results = {"Message": "INFO:Initialized_INFO:Projecting from: 26917 To: 4326_INFO:Number of vertices: 12009_INFO:Simplifying feature with tolerance: 30_INFO:Executing: SimplifyPolygon D:\\gistemp\\ClientData\\oh20151104132849041000\\Temp\\globalwatershed.shp D:\\gistemp\\ClientData\\oh20151104132849041000\\Tempsimplified.shp POINT REMOVE \"30 Meters\" \"0 Unknown\" RESOLVE ERRORS KEEP COLLAPSED POINTS Start Time: Fri Nov 06 12:09:47 2015 Analyzing input features... Simplifying polygons... Reading Features... Assembling Features... Cracking Features... Detecting topological errors... Reading Features... Cracking Features... Assembling Features... Reconstructing polygons... No topological errors were detected. Succeeded at Fri Nov 06 12:09:48 2015 (Elapsed Time: 0.48 seconds)_", "Features": [{"name": "globalwatershed", "feature": {"fields": [{"alias": "FID", "type": "esriFieldTypeOID", "name": "FID"}, {"alias": "OBJECTID", "type": "esriFieldTypeInteger", "name": "OBJECTID"}, {"alias": "HYDROID", "type": "esriFieldTypeInteger", "name": "HYDROID"}, {"alias": "DRAINID", "type": "esriFieldTypeInteger", "name": "DRAINID"}, {"alias": "NAME", "length": 25, "type": "esriFieldTypeString", "name": "NAME"}, {"alias": "DESCRIPT", "length": 25, "type": "esriFieldTypeString", "name": "DESCRIPT"}, {"alias": "GLOBALWSHD", "type": "esriFieldTypeInteger", "name": "GLOBALWSHD"}, {"alias": "RELATEDOID", "length": 250, "type": "esriFieldTypeString", "name": "RELATEDOID"}, {"alias": "HUCID", "length": 25, "type": "esriFieldTypeString", "name": "HUCID"}, {"alias": "OHREGA", "type": "esriFieldTypeDouble", "name": "OHREGA"}, {"alias": "OHREGC", "type": "esriFieldTypeDouble", "name": "OHREGC"}, {"alias": "DRNAREA", "type": "esriFieldTypeDouble", "name": "DRNAREA"}, {"alias": "FOREST", "type": "esriFieldTypeDouble", "name": "FOREST"}, {"alias": "PRECIP", "type": "esriFieldTypeDouble", "name": "PRECIP"}, {"alias": "DESCRIPTIO", "length": 20, "type": "esriFieldTypeString", "name": "DESCRIPTIO"}, {"alias": "PK2", "type": "esriFieldTypeDouble", "name": "PK2"}, {"alias": "PK5", "type": "esriFieldTypeDouble", "name": "PK5"}, {"alias": "PK10", "type": "esriFieldTypeDouble", "name": "PK10"}, {"alias": "PK25", "type": "esriFieldTypeDouble", "name": "PK25"}, {"alias": "PK50", "type": "esriFieldTypeDouble", "name": "PK50"}, {"alias": "PK100", "type": "esriFieldTypeDouble", "name": "PK100"}, {"alias": "PK500", "type": "esriFieldTypeDouble", "name": "PK500"}, {"alias": "Q1", "type": "esriFieldTypeDouble", "name": "Q1"}, {"alias": "Q2", "type": "esriFieldTypeDouble", "name": "Q2"}, {"alias": "Q3", "type": "esriFieldTypeDouble", "name": "Q3"}, {"alias": "Q4", "type": "esriFieldTypeDouble", "name": "Q4"}, {"alias": "Q5", "type": "esriFieldTypeDouble", "name": "Q5"}, {"alias": "Q6", "type": "esriFieldTypeDouble", "name": "Q6"}, {"alias": "Q7", "type": "esriFieldTypeDouble", "name": "Q7"}, {"alias": "Q8", "type": "esriFieldTypeDouble", "name": "Q8"}, {"alias": "Q9", "type": "esriFieldTypeDouble", "name": "Q9"}, {"alias": "QA", "type": "esriFieldTypeDouble", "name": "QA"}, {"alias": "Q10", "type": "esriFieldTypeDouble", "name": "Q10"}, {"alias": "Q11", "type": "esriFieldTypeDouble", "name": "Q11"}, {"alias": "Q12", "type": "esriFieldTypeDouble", "name": "Q12"}, {"alias": "QAH", "type": "esriFieldTypeDouble", "name": "QAH"}, {"alias": "Q50", "type": "esriFieldTypeDouble", "name": "Q50"}, {"alias": "LAT_CENT", "type": "esriFieldTypeDouble", "name": "LAT_CENT"}, {"alias": "LONG_CENT", "type": "esriFieldTypeDouble", "name": "LONG_CENT"}, {"alias": "FPS25", "type": "esriFieldTypeDouble", "name": "FPS25"}, {"alias": "FPS50", "type": "esriFieldTypeDouble", "name": "FPS50"}, {"alias": "FPS75", "type": "esriFieldTypeDouble", "name": "FPS75"}, {"alias": "CSL1085LFP", "type": "esriFieldTypeDouble", "name": "CSL1085LFP"}, {"alias": "Edited", "type": "esriFieldTypeInteger", "name": "Edited"}, {"alias": "WarningMsg", "length": 200, "type": "esriFieldTypeString", "name": "WarningMsg"}, {"alias": "M1D10Y", "type": "esriFieldTypeDouble", "name": "M1D10Y"}, {"alias": "M7D10Y", "type": "esriFieldTypeDouble", "name": "M7D10Y"}, {"alias": "M30D10Y", "type": "esriFieldTypeDouble", "name": "M30D10Y"}, {"alias": "M90D10Y", "type": "esriFieldTypeDouble", "name": "M90D10Y"}, {"alias": "D80", "type": "esriFieldTypeDouble", "name": "D80"}, {"alias": "LC11IMP", "type": "esriFieldTypeDouble", "name": "LC11IMP"}, {"alias": "LC11DEV", "type": "esriFieldTypeDouble", "name": "LC11DEV"}, {"alias": "LC92STOR", "type": "esriFieldTypeDouble", "name": "LC92STOR"}, {"alias": "STREAM_VAR", "type": "esriFieldTypeDouble", "name": "STREAM_VAR"}, {"alias": "PROB_1DAY", "type": "esriFieldTypeDouble", "name": "PROB_1DAY"}, {"alias": "PROB_7DAY", "type": "esriFieldTypeDouble", "name": "PROB_7DAY"}, {"alias": "PROB_30DAY", "type": "esriFieldTypeDouble", "name": "PROB_30DAY"}, {"alias": "ORIG_FID", "type": "esriFieldTypeInteger", "name": "ORIG_FID"}, {"alias": "Shape_Leng", "type": "esriFieldTypeDouble", "name": "Shape_Leng"}, {"alias": "Shape_Area", "type": "esriFieldTypeDouble", "name": "Shape_Area"}, {"alias": "WEIGHTED", "type": "esriFieldTypeSmallInteger", "name": "WEIGHTED"}, {"alias": "numVert", "type": "esriFieldTypeInteger", "name": "numVert"}, {"alias": "MaxSimpTol", "type": "esriFieldTypeDouble", "name": "MaxSimpTol"}, {"alias": "MinSimpTol", "type": "esriFieldTypeDouble", "name": "MinSimpTol"}], "displayFieldName": "", "geometryType": "esriGeometryPolygon", "features": [{"geometry": {"rings": [[[-82.3535329515901, 40.68540585065588], [-82.35353477267046, 40.68549584947477], [-82.35365299726004, 40.68549446316255], [-82.3535329515901, 40.68540585065588]], [[-82.3535329515901, 40.68540585065588], [-82.35278121776513, 40.68334273266859], [-82.35405893933608, 40.682156757435195], [-82.35546760585471, 40.681599738047154], [-82.35494317094224, 40.679083494769415], [-82.35609343330174, 40.677448523553316], [-82.3558291462232, 40.6761002221785], [-82.35498296263627, 40.675209591877525], [-82.35496107243782, 40.674128501759476], [-82.35646951747087, 40.67266973140261], [-82.35620937933993, 40.6715014200124], [-82.35572879577, 40.67114698690678], [-82.35407483444948, 40.67125641732875], [-82.35382021307706, 40.6703584660444], [-82.3562856032273, 40.66942859020585], [-82.35795096348873, 40.669859482437964], [-82.35939043529856, 40.67083349701886], [-82.36233088009217, 40.66998828725775], [-82.36271346184273, 40.6713348088375], [-82.36453151343449, 40.67347528665116], [-82.36809848272713, 40.67433400573882], [-82.37050143162789, 40.67610737503894], [-82.37179900123556, 40.67591155305169], [-82.37229584223678, 40.677076644144], [-82.37646575900405, 40.6784684204455], [-82.37781714667514, 40.68088467531751], [-82.3808047355342, 40.68229040018397], [-82.38281963716011, 40.68244631927104], [-82.38375842431977, 40.682074621642805], [-82.384305278288, 40.67990611794051], [-82.38628093212364, 40.678170929787704], [-82.38626787218517, 40.67754057997944], [-82.38505496623812, 40.676113715781625], [-82.38549471968626, 40.67448697831538], [-82.38523171829671, 40.673228750845254], [-82.38744964649727, 40.67176106260551], [-82.38928760310463, 40.66912653941951], [-82.3906999180021, 40.66874908588095], [-82.39146761212868, 40.67153229238923], [-82.39540442210279, 40.673106235047484], [-82.3965855362959, 40.67300193199302], [-82.39896985936147, 40.673873996666295], [-82.40197453775396, 40.67608951186542], [-82.40327389995232, 40.67598370405633], [-82.40541631923058, 40.67658814687115], [-82.40698807795837, 40.67819045991935], [-82.40670351092363, 40.68152723308663], [-82.41088578432661, 40.68345809652226], [-82.41491577666032, 40.68376884553767], [-82.41891666572508, 40.68272878382145], [-82.41942250933705, 40.68425400145888], [-82.42178886523362, 40.68422487928026], [-82.42389721068429, 40.68320831135868], [-82.4245686469808, 40.68139816357831], [-82.42775663114466, 40.68108834797385], [-82.42843564416496, 40.679638900414005], [-82.43157131760809, 40.682392500856956], [-82.43396027226689, 40.68344381967207], [-82.43548890651967, 40.682974353798784], [-82.43663675602818, 40.68133861889712], [-82.44008102419237, 40.687421440689604], [-82.44137859154664, 40.687225205996846], [-82.4428931635747, 40.68612494484914], [-82.44419653621412, 40.6861990343888], [-82.44501485280745, 40.68573832912997], [-82.44575191775385, 40.68699010651261], [-82.44542254375556, 40.68816521819799], [-82.44768395036394, 40.68876775097828], [-82.44841525280955, 40.689749525727514], [-82.44997466864521, 40.69072052479435], [-82.45245358688105, 40.690419301902566], [-82.45560313612131, 40.6883077130595], [-82.45690459284042, 40.688291293906616], [-82.45905179951626, 40.689075083702086], [-82.46109852921202, 40.69067064277433], [-82.46252416101228, 40.69092264474535], [-82.46362814149069, 40.69271050925921], [-82.46540901410629, 40.692957968426676], [-82.46310348565538, 40.69578001969215], [-82.463119247381, 40.69650033907931], [-82.46409374366502, 40.697748985081546], [-82.46425143444749, 40.6995488386774], [-82.46545262276875, 40.700344132034346], [-82.46541926551508, 40.70421831882439], [-82.4727538448705, 40.7040349432883], [-82.47597494553119, 40.70516477813727], [-82.47796084729458, 40.70396838430899], [-82.47909053913652, 40.70152156176149], [-82.4802455922518, 40.70024575352217], [-82.48056890286102, 40.69880019960169], [-82.47946587476008, 40.69710250854054], [-82.47944196368714, 40.69602185190543], [-82.48117510573115, 40.69410812168091], [-82.4838864561, 40.69362283443923], [-82.48446811259593, 40.69316489116633], [-82.48478482248004, 40.69144935307563], [-82.48364634164554, 40.6881307079579], [-82.48596226325239, 40.68584896928656], [-82.4878472228344, 40.68546424301421], [-82.49011490908705, 40.68633591836931], [-82.49449045434561, 40.686189330728524], [-82.49660979684097, 40.685711409084846], [-82.49940862692974, 40.68387360250832], [-82.50113535073892, 40.68700403452362], [-82.50258937113678, 40.68851654289905], [-82.50656060368296, 40.69143724187675], [-82.50917374037337, 40.691853566795196], [-82.5125966669329, 40.69144831738064], [-82.51315365336623, 40.68990959192718], [-82.51671715110614, 40.6904936914236], [-82.51812866172332, 40.690114691095765], [-82.51913638679791, 40.68757906546044], [-82.51932373675888, 40.68541467405967], [-82.5202576797239, 40.68486189453174], [-82.5205821033435, 40.68350623376774], [-82.5219955002654, 40.68321755032179], [-82.5226806677573, 40.682127549989666], [-82.52551968182017, 40.6820900647742], [-82.5270758944321, 40.682880024284714], [-82.52824047880522, 40.68205407490116], [-82.52956236392346, 40.6829374932662], [-82.53216497952623, 40.68290297664766], [-82.53408880427259, 40.68422844146796], [-82.53197137343774, 40.68479704401763], [-82.53116193465907, 40.68561869146726], [-82.53228255714143, 40.68803579807697], [-82.53371044564851, 40.688377278032746], [-82.53577130166181, 40.690511798360525], [-82.53656597543225, 40.69419456520783], [-82.53980580309218, 40.696133272911894], [-82.5370262473983, 40.698782700074176], [-82.53767179108347, 40.701116426931094], [-82.53852070500423, 40.70200566654894], [-82.53855179817751, 40.70335663557217], [-82.54095191782578, 40.70476601621343], [-82.54062988506178, 40.70621134549964], [-82.541358582465, 40.707012520178154], [-82.5433662068655, 40.70680565364136], [-82.54768512450538, 40.70926980557648], [-82.54534925809298, 40.71065248693532], [-82.54481367791483, 40.71309199338896], [-82.54711845655592, 40.715493085858164], [-82.54961031803566, 40.715730077851575], [-82.55033087023028, 40.71617086112909], [-82.55179290782802, 40.717952678232734], [-82.55171856003406, 40.71984553523854], [-82.55315141174947, 40.720366737507085], [-82.5529713836923, 40.722801491387905], [-82.55441687961596, 40.723862983557], [-82.55362191533605, 40.72531471284329], [-82.55049892528247, 40.72850955627728], [-82.54671066282087, 40.72856039175648], [-82.54390301389499, 40.73003938347891], [-82.54338181747154, 40.733109178537504], [-82.54412750749985, 40.734630614136876], [-82.54442292535998, 40.73714900617836], [-82.54656643193826, 40.73766077401927], [-82.54976109462251, 40.737527896166014], [-82.553995836764, 40.7362996083383], [-82.55789604403901, 40.73597696750025], [-82.55883083980203, 40.73542386856871], [-82.56178826679218, 40.735293862543294], [-82.56381353375494, 40.73580690982449], [-82.56710311286076, 40.734681334235134], [-82.56925940085176, 40.73573298124132], [-82.57056171289592, 40.73571526403806], [-82.57235468581042, 40.736411358423304], [-82.57370321955464, 40.73837483917001], [-82.57647515504424, 40.74040888567546], [-82.58054116445527, 40.742064704999954], [-82.58490936021938, 40.741464317348004], [-82.58906822434491, 40.74203761052591], [-82.59093694838904, 40.7409309144625], [-82.5919032565484, 40.74172848438461], [-82.59156715926888, 40.74254401523777], [-82.59145098948859, 40.7426356353577], [-82.59156930484717, 40.74263400353076], [-82.59156715926888, 40.74254401523777], [-82.59559921383457, 40.742758383784235], [-82.59679410307724, 40.743192312036676], [-82.59658547213938, 40.74436616266955], [-82.59485444031937, 40.746281942437534], [-82.5944430580385, 40.74889997518848], [-82.59694707214283, 40.74958585540021], [-82.59709557605582, 40.750845149778236], [-82.5987708932575, 40.75154245513942], [-82.59974823970394, 40.752789888743656], [-82.59955259501122, 40.75450440596501], [-82.600626731502, 40.754849577563334], [-82.6000907211276, 40.75719930549645], [-82.59951844774905, 40.758017762891015], [-82.60026354410087, 40.759448814351906], [-82.5977914705455, 40.76011356108485], [-82.59744888700175, 40.760658777889], [-82.59952484782463, 40.76324235825411], [-82.59931405385923, 40.764326224345744], [-82.6010519470676, 40.76763533561004], [-82.60358705334086, 40.76958197971977], [-82.60456909435044, 40.771009334908925], [-82.60441686661468, 40.77452469438355], [-82.60326467326428, 40.77589207288757], [-82.6048158194174, 40.77632096131688], [-82.60530448759656, 40.776944650025825], [-82.60536086066722, 40.77928577879622], [-82.608671381275, 40.77896961582975], [-82.61131899422725, 40.780644093326146], [-82.61319929284575, 40.77998733019364], [-82.61865956944524, 40.78036130397767], [-82.6209935886944, 40.778887159261245], [-82.62208186764748, 40.779772768575036], [-82.62610086657918, 40.77935575553689], [-82.6274123040792, 40.779697699888835], [-82.62810106462504, 40.77878707724586], [-82.63413601745185, 40.77843170429204], [-82.63570065538183, 40.77940008179911], [-82.63652978231099, 40.77938832345743], [-82.6372184225042, 40.77847801810926], [-82.63899281324636, 40.77836280861159], [-82.64004586326875, 40.77780700416707], [-82.6420619066869, 40.7778687138551], [-82.64451367702193, 40.776392419379725], [-82.64459477381112, 40.77485987376416], [-82.64539717502042, 40.773767494366105], [-82.64477153410864, 40.772425057579305], [-82.64750031090685, 40.772566527046116], [-82.64870941939067, 40.77354017624782], [-82.64873613837618, 40.774620730962596], [-82.64994258091548, 40.77550401824129], [-82.65009487024729, 40.77685319679932], [-82.65166367465154, 40.77800170078359], [-82.65180213341786, 40.77881060663416], [-82.65044530846822, 40.78144234833402], [-82.65194940883737, 40.78475364368447], [-82.6524814909074, 40.787088296755066], [-82.6553762350708, 40.78911864797973], [-82.65575826010321, 40.790194098829254], [-82.65744860571905, 40.79143079182198], [-82.65785084652602, 40.79331683056911], [-82.6588124750011, 40.793843473073295], [-82.65900038031631, 40.796633119545255], [-82.66048507235487, 40.79913405713703], [-82.66052098782103, 40.800574905425], [-82.66124767375663, 40.80119492467916], [-82.66163436050947, 40.802450319155625], [-82.66295590461588, 40.803152143062256], [-82.66468497853211, 40.8059195468753], [-82.66461832082626, 40.80799235328741], [-82.66534963473116, 40.808792680928015], [-82.6655018388228, 40.81014146004477], [-82.66389635669734, 40.81232648952327], [-82.66399537708078, 40.81628871442114], [-82.6653037013522, 40.816449863926884], [-82.66606441527729, 40.81842070489873], [-82.66823398420189, 40.81983070687275], [-82.66994566198461, 40.82187777882914], [-82.67415322848657, 40.82415866899264], [-82.67705934448358, 40.826548719485885], [-82.68270825752643, 40.82484505595502], [-82.68507246124491, 40.82454012433275], [-82.68828230333712, 40.82485361737237], [-82.69130740326617, 40.827241563962346], [-82.69298283377746, 40.82784746147468], [-82.69510510169346, 40.82736584468122], [-82.69685130397454, 40.82607921243416], [-82.70017511324235, 40.826210295437015], [-82.70378886622356, 40.82840883320805], [-82.7040649874205, 40.829936123675566], [-82.7052805852532, 40.83108909529606], [-82.70569879208877, 40.833515171957664], [-82.70560292128947, 40.83441748150972], [-82.70479389850728, 40.835239949191326], [-82.70115566077628, 40.83673502431405], [-82.69988136709948, 40.837924750319495], [-82.69957376044218, 40.83982108241369], [-82.70091256339006, 40.84115268304301], [-82.7048831176676, 40.843345912534545], [-82.7066757393443, 40.84385985863587], [-82.70809856408819, 40.843838794395914], [-82.70949823891002, 40.84291716560574], [-82.71290661188809, 40.84169565847092], [-82.7179954858265, 40.84125953474419], [-82.72157568914103, 40.84210703667016], [-82.72477717361616, 40.8420592020753], [-82.72775756963014, 40.842645065639005], [-82.72836920231633, 40.843356760643886], [-82.728183704852, 40.84534134888483], [-82.72868388393923, 40.84632438530314], [-82.73434371789797, 40.849572547297804], [-82.7336815470757, 40.851473922719], [-82.73112184514093, 40.853404164944884], [-82.73114763548156, 40.85439468029036], [-82.73500095906586, 40.85658861991962], [-82.7364310929037, 40.856837508124244], [-82.7366183054537, 40.85944696454177], [-82.7383326240692, 40.8614929506249], [-82.74095373749897, 40.86190385108345], [-82.74320229995591, 40.86168948435241], [-82.74524455663781, 40.86264949263906], [-82.74782063498827, 40.86585321875625], [-82.74932211822974, 40.86880314625115], [-82.7502708382292, 40.868788750036884], [-82.75448137862404, 40.86647292498747], [-82.76400360541386, 40.867588591748046], [-82.76628099950148, 40.8684546151438], [-82.76678671691147, 40.86961779316561], [-82.76799934103205, 40.87059010426294], [-82.77399037217604, 40.872749925089565], [-82.77400479663136, 40.8732901577837], [-82.77298506343428, 40.87510760604297], [-82.76848963379605, 40.87562708020727], [-82.76503336190389, 40.87955323799833], [-82.76303093024802, 40.88012432709381], [-82.7612994830266, 40.881952550366314], [-82.76086775495216, 40.88358050903952], [-82.76028642787777, 40.88403982664285], [-82.7581533412849, 40.88416238471072], [-82.75770722481838, 40.885250096608424], [-82.75533697674855, 40.88537621784099], [-82.75326327027766, 40.88774998662742], [-82.75318036114726, 40.889102198009574], [-82.75051549999222, 40.891574917099945], [-82.74955410161718, 40.89113906994363], [-82.74747526805056, 40.89333241336793], [-82.7432486181651, 40.89510777213886], [-82.74131874388117, 40.89847004608639], [-82.74218475255189, 40.89980791307052], [-82.74009597123163, 40.90164121662224], [-82.74013610334882, 40.903171958652436], [-82.73943586941877, 40.903632965855785], [-82.73729738441716, 40.90357482536931], [-82.73659948774275, 40.90412616426412], [-82.73724714278559, 40.90618783676395], [-82.73644711316243, 40.90737118140809], [-82.7362565403942, 40.9091754401712], [-82.73557741732449, 40.91044697033422], [-82.73571956961159, 40.9113453395273], [-82.73670474972108, 40.91268181992148], [-82.73460128616459, 40.9139744219127], [-82.73298866645989, 40.91589044496661], [-82.73288786080398, 40.92111646115618], [-82.73184043387683, 40.92194306563162], [-82.7311634419472, 40.92330417942041], [-82.73011410134542, 40.92404078257462], [-82.72799138732859, 40.924613072100875], [-82.72731194668538, 40.92588418732711], [-82.72516757573328, 40.92564588665618], [-82.72422505587423, 40.92593039826423], [-82.72376875640865, 40.92665770121161], [-82.72426485608909, 40.927461146679185], [-82.72023765913282, 40.92788173676666], [-82.71707215246323, 40.929460273641645], [-82.71245340468165, 40.92997904502252], [-82.71107056989001, 40.931621306504525], [-82.7111007761856, 40.93279177684651], [-82.70705460464832, 40.93249133886313], [-82.70481507723609, 40.93315494702062], [-82.70436083784146, 40.93397252870662], [-82.70440250411926, 40.93559327106356], [-82.70631860839681, 40.936195389569285], [-82.706481298167, 40.93790435321508], [-82.70569193510836, 40.93953776254456], [-82.70596864802324, 40.941065010247264], [-82.7044459115402, 40.94189802833582], [-82.70250813440626, 40.94507936277215], [-82.69800684588559, 40.94559619412675], [-82.69272489830769, 40.94810609947209], [-82.68348706760392, 40.94923190513927], [-82.68220808268666, 40.95033185210887], [-82.68019363555604, 40.9505412596273], [-82.67892825040178, 40.95218105439785], [-82.67490603889242, 40.952870035369855], [-82.67228670924057, 40.952638024537976], [-82.67044822552535, 40.950412488073525], [-82.66365370144855, 40.949519859146044], [-82.66336209919181, 40.94736225493865], [-82.66287787970838, 40.94700918678554], [-82.66112563919097, 40.94820537085965], [-82.66029666896269, 40.94830732652063], [-82.65672717127468, 40.9480886422931], [-82.6559049402245, 40.94846051303059], [-82.65565408793357, 40.94792366333025], [-82.65244738164373, 40.947969676783565], [-82.65188493946957, 40.94923904284756], [-82.64859084327641, 40.95054713683296], [-82.6480126215436, 40.95118587087497], [-82.64819402402642, 40.95370551630629], [-82.6492923237924, 40.95486072669622], [-82.6447002564779, 40.956547699945844], [-82.6427279124006, 40.95846759646201], [-82.64193672559458, 40.960100228844894], [-82.64014188631684, 40.959585329451905], [-82.63881072257955, 40.95861337047505], [-82.63632059485909, 40.95882914559016], [-82.63616853194678, 40.957479985484476], [-82.63370063646094, 40.95859589574121], [-82.63342549720245, 40.95706844873891], [-82.63184378929444, 40.95555950501818], [-82.63136853501877, 40.955566232165815], [-82.63165249383354, 40.95745398568226], [-82.63036581285515, 40.9582826869027], [-82.62821675373232, 40.957862994520255], [-82.6250778987849, 40.95583548905833], [-82.62281857759795, 40.95577693518103], [-82.6217652950224, 40.95642259676425], [-82.62087645120047, 40.95895696953296], [-82.61821092546106, 40.96169706100535], [-82.61802141647983, 40.963681137300696], [-82.61841763970251, 40.965297304892275], [-82.61496320457204, 40.96984941060661], [-82.61318584755402, 40.97005469845004], [-82.61279191975716, 40.968528865464926], [-82.61182855528425, 40.96800188829591], [-82.60791895001681, 40.968506563015524], [-82.60042574842106, 40.96825079379976], [-82.59789291950939, 40.971618670570116], [-82.59682996282379, 40.97190381482242], [-82.59575445416183, 40.971648296878634], [-82.59459010654965, 40.97265530475483], [-82.59281428098944, 40.97295027216835], [-82.59145569913451, 40.975761319153044], [-82.58933438411212, 40.976511072205845], [-82.5856275351518, 40.97557123381606], [-82.58368976780993, 40.97406652812011], [-82.58110592132836, 40.97536330728851], [-82.579684477725, 40.975562825047625], [-82.578468289327, 40.97440856529505], [-82.57140925800637, 40.97243321843909], [-82.57034024253707, 40.97244778784877], [-82.56893590273857, 40.973367792866455], [-82.56573421191997, 40.97368137229243], [-82.56390503327924, 40.97172441447726], [-82.56389440659926, 40.971274488441274], [-82.56482814167795, 40.97054096219584], [-82.56266205093375, 40.96939942512475], [-82.56251309929233, 40.96814050714546], [-82.56120197172946, 40.96797787417322], [-82.560381068352, 40.9684394300487], [-82.55952622062588, 40.96746010437534], [-82.55724583884204, 40.966500038287464], [-82.55668370952206, 40.962814455701675], [-82.5558437952973, 40.96246536827933], [-82.55525400163557, 40.96265372694266], [-82.55307519365398, 40.96601585344715], [-82.55093475579467, 40.965954658680744], [-82.54936682289178, 40.96498484722631], [-82.54782257513678, 40.96500559409027], [-82.54549727555093, 40.96719861931871], [-82.5451679567197, 40.9683743314223], [-82.54088901719494, 40.96834122674401], [-82.53980700223225, 40.96781523072402], [-82.53887350844518, 40.96854855231858], [-82.53755197833442, 40.96793571757963], [-82.53638469437631, 40.96885179616133], [-82.53366050621476, 40.9692485027728], [-82.53206197625676, 40.96692753633669], [-82.53014854664573, 40.9664124968356], [-82.52980487655336, 40.96695751459781], [-82.52996104776132, 40.96857718272383], [-82.52903158134202, 40.96949002854099], [-82.52819123988436, 40.9691411164972], [-82.5276955773759, 40.96824680326244], [-82.52592990498272, 40.96899067582883], [-82.52354572460995, 40.96866215744922], [-82.52225537136391, 40.969399690244856], [-82.51846157952777, 40.969810158756744], [-82.51764859623125, 40.97063136546072], [-82.51635195544452, 40.97109887354381], [-82.51415029913134, 40.973560055465896], [-82.51293320324176, 40.97231472562984], [-82.51139492893374, 40.972605319391604], [-82.51080901060611, 40.97297305920354], [-82.50932408852303, 40.975605151881844], [-82.50637991871757, 40.97681459460994], [-82.50504622971434, 40.98088562470653], [-82.5026841892592, 40.9815469146401], [-82.50069059047874, 40.98274381540118], [-82.49926260386125, 40.98267238433558], [-82.49745139628702, 40.981434618824785], [-82.4987014921351, 40.97889648666123], [-82.49856847403564, 40.97826737554141], [-82.49543200802552, 40.9762362996145], [-82.49293099283679, 40.975998677607], [-82.49254181338546, 40.97456237456224], [-82.49133573888608, 40.973767485276646], [-82.48999019936157, 40.97207313121994], [-82.4904326832908, 40.970626066163625], [-82.49206385879924, 40.96916398945157], [-82.49190252728833, 40.967274290694895], [-82.48995088961189, 40.96504768881993], [-82.48875464619957, 40.96470271630298], [-82.48626418434442, 40.964914883873604], [-82.48428087256038, 40.96656218401798], [-82.48284871955556, 40.966310203075025], [-82.48383141645427, 40.96242433465714], [-82.48356978155448, 40.961346414802435], [-82.47924855407969, 40.95942051245852], [-82.4778210864531, 40.959348808197234], [-82.47791014243249, 40.957996333411295], [-82.47647267031871, 40.95747429551527], [-82.47606992212293, 40.95540762987869], [-82.47451382062648, 40.95488708599025], [-82.47342452424236, 40.954000125406075], [-82.47266181316122, 40.951758018933944], [-82.47041516162513, 40.95223714200121], [-82.46873400360238, 40.95144769986493], [-82.4649313844112, 40.95140607046793], [-82.45976859212534, 40.94894929119484], [-82.4575254037137, 40.94960815066716], [-82.45041089736192, 40.950238344061425], [-82.44656067430483, 40.94803486481809], [-82.44452776811087, 40.947429879901975], [-82.44014318620941, 40.947935183110495], [-82.4395199123036, 40.946591630676295], [-82.44044248999543, 40.94531915291998], [-82.44041312995996, 40.943968180443775], [-82.439303440674, 40.94209023925838], [-82.43282618747273, 40.939198568927814], [-82.43111858372215, 40.93714794555155], [-82.42897717607113, 40.93699410677552], [-82.42849036793928, 40.93645967752294], [-82.4282355760183, 40.93565232559389], [-82.4303477937567, 40.93445519825539], [-82.43044896796854, 40.93364306286321], [-82.42699365748628, 40.933145420661006], [-82.42409737994154, 40.93101938032194], [-82.41959311433163, 40.93143536296245], [-82.41839012283597, 40.9307293045461], [-82.41831115515761, 40.927037045857794], [-82.41684402649123, 40.9250732597343], [-82.41480440039078, 40.924107393762384], [-82.41486733852149, 40.92149431637218], [-82.4132645357826, 40.918721635111595], [-82.4121900674372, 40.91846438358929], [-82.41018899955087, 40.919299757205884], [-82.4085270810827, 40.91932007207647], [-82.40673648249746, 40.918891484991356], [-82.40493304730748, 40.91783254350113], [-82.40136199802168, 40.917425554012354], [-82.4010690860662, 40.91481680188994], [-82.40033400391363, 40.91374480162112], [-82.40012226693715, 40.90933362962908], [-82.40185929930557, 40.90724067602292], [-82.40253532804682, 40.9055206696845], [-82.40204326505558, 40.90471613981893], [-82.40072043579079, 40.90392133327541], [-82.40057332667035, 40.90257213790266], [-82.40269833861623, 40.90200584065649], [-82.40280362743664, 40.901374076879556], [-82.40158805560137, 40.900037506593556], [-82.40039581554029, 40.899781574372184], [-82.40070792616643, 40.897705932339086], [-82.3987746972724, 40.89610799784201], [-82.3986352321144, 40.89511877087101], [-82.39755600548527, 40.894591389078904], [-82.39777424299263, 40.893688211210765], [-82.39870829779093, 40.89295601483905], [-82.39808310204864, 40.891432210177044], [-82.39949197336523, 40.89069462080214], [-82.3997006736906, 40.8893407329245], [-82.39777530173087, 40.888103118471626], [-82.3960649322983, 40.88578156356927], [-82.39404005862895, 40.88544599353306], [-82.39590850175148, 40.883982019569494], [-82.39302104911972, 40.882125110805234], [-82.39300405677567, 40.88131479837767], [-82.39452189029178, 40.88012549986911], [-82.3953031833178, 40.87777377008167], [-82.3951732726354, 40.877234873256015], [-82.39218407618237, 40.876190059035366], [-82.39240469842613, 40.87537650745539], [-82.39310900777502, 40.875007934601115], [-82.39296212351098, 40.873658350047045], [-82.39140620360153, 40.873046646884966], [-82.38510888728939, 40.872672001418316], [-82.38212615105326, 40.87189689653866], [-82.38163833550014, 40.871272254988796], [-82.38221661388923, 40.87054482314346], [-82.38229769926791, 40.86874203809493], [-82.37833455157265, 40.86644755562166], [-82.37594676518874, 40.86575556518738], [-82.37449903490615, 40.86460149918257], [-82.37398714741971, 40.86280615238148], [-82.37201697675745, 40.8650815086352], [-82.3703823845452, 40.86636228829611], [-82.36943723599707, 40.86655354818359], [-82.3677668494622, 40.86612291766897], [-82.36320560712939, 40.86356458287491], [-82.36141679463694, 40.86313525940667], [-82.35727964513778, 40.86390489779817], [-82.35512422001548, 40.86293931761383], [-82.35226812324937, 40.86252238564071], [-82.35308556050796, 40.86188230930202], [-82.35503059610872, 40.85834622247778], [-82.35500857096133, 40.857265536177245], [-82.35390413510433, 40.85547668623467], [-82.35437436569116, 40.84943595041387], [-82.35131433813359, 40.844787618380984], [-82.34625516890222, 40.8409730759777], [-82.34501454937369, 40.83828517973639], [-82.34270529418716, 40.8355196950729], [-82.34043202377391, 40.83455520289451], [-82.3407770980453, 40.83401071811937], [-82.34336945941655, 40.83316965987588], [-82.34406269198274, 40.8322610395751], [-82.34390782747317, 40.83046101527935], [-82.34246821485863, 40.82966725004208], [-82.34264933973834, 40.826872379176045], [-82.34110041028289, 40.82652995740244], [-82.34048808190724, 40.82554651255422], [-82.3409619808023, 40.82554100449559], [-82.34151853807751, 40.82373270050975], [-82.3407600617887, 40.82139958139522], [-82.34099155046191, 40.82112646817314], [-82.34407958944084, 40.821360951019436], [-82.35139883406518, 40.81974402825966], [-82.35329889337409, 40.81990178963181], [-82.35365111317905, 40.819717620631224], [-82.35352166271227, 40.819178664501806], [-82.351956887412, 40.81802567419689], [-82.34958389137633, 40.81796344439451], [-82.34976470619749, 40.81516893140754], [-82.34703413504413, 40.815020813693536], [-82.34344894118003, 40.81362122756361], [-82.34306633035354, 40.81227430792556], [-82.34308488723153, 40.80731978320752], [-82.34187952848592, 40.806342873469255], [-82.34162631788365, 40.805534918689645], [-82.33532297015437, 40.804527095526495], [-82.33070377214484, 40.79881524941165], [-82.32867287387822, 40.798028124785375], [-82.32620775517226, 40.79922746292662], [-82.32240794965757, 40.798910638402404], [-82.32119768998572, 40.797663511182066], [-82.31820834808104, 40.796346323987905], [-82.3138254996509, 40.79648633749616], [-82.31239455967737, 40.79605216253999], [-82.31083409533616, 40.795078962808525], [-82.30961930280834, 40.793561710745074], [-82.30947207620694, 40.792121981045526], [-82.31073843693345, 40.79021573620852], [-82.31129555641652, 40.78840793209971], [-82.31088186953889, 40.785439808257806], [-82.30965968192403, 40.78356182275301], [-82.31247135666835, 40.78190843213268], [-82.31207184922158, 40.7796610374172], [-82.31510765021041, 40.777374534361776], [-82.3142091973319, 40.77387146303409], [-82.31520054456527, 40.77007679983656], [-82.31033302796767, 40.769591697710624], [-82.30901752633471, 40.76897575773427], [-82.30840621111929, 40.76799174825113], [-82.308142486036, 40.766643718341655], [-82.3085917199657, 40.765377253962505], [-82.30854755398221, 40.76312580966573], [-82.30815488565618, 40.7612387590687], [-82.30904090163881, 40.75807546623907], [-82.30814129587968, 40.7544826973628], [-82.31523948984508, 40.74800586614505], [-82.31520754700666, 40.746384781861174], [-82.3162451251728, 40.744931538715974], [-82.31608014306296, 40.74259144910296], [-82.31642673479348, 40.7421370322938], [-82.31819422292, 40.74166639106381], [-82.31808576495624, 40.73617277254843], [-82.31408620235442, 40.731534061688734], [-82.3142873714096, 40.72972990913907], [-82.31187909850983, 40.72768538941488], [-82.31087691288681, 40.72490433149368], [-82.31108041036799, 40.72319054518215], [-82.31012424635816, 40.72275093611949], [-82.31023370830975, 40.722299226467314], [-82.31223022701292, 40.72146563130482], [-82.31291568720002, 40.72019682561062], [-82.3125077448673, 40.717499036760174], [-82.3109248899907, 40.71526469215102], [-82.31063661735739, 40.712655553035766], [-82.31108547502123, 40.71138944483571], [-82.31094247064301, 40.710130056772805], [-82.30914223314377, 40.708889107407494], [-82.30865152029146, 40.70799373765982], [-82.30885278728617, 40.706189955657656], [-82.31060172750807, 40.70481870705268], [-82.30941813191808, 40.704832140300525], [-82.30643977589317, 40.70387493414983], [-82.3028368590712, 40.70121322007135], [-82.30245051132, 40.699596116342384], [-82.30159770726355, 40.69834472218759], [-82.30306924603298, 40.6949047797248], [-82.30325658825346, 40.692380262150174], [-82.3020258720654, 40.68996213855539], [-82.29998336965473, 40.68836369172236], [-82.29960717720891, 40.68728657926962], [-82.30123886911059, 40.68600717943599], [-82.30074318482409, 40.68484176795987], [-82.30214535391772, 40.68392502131647], [-82.30259896435741, 40.682928944616854], [-82.3059099068781, 40.68280151766946], [-82.30860633077693, 40.68150996380889], [-82.31121266815947, 40.681660428124566], [-82.31179013723718, 40.68093333951551], [-82.31510979969109, 40.68125564690633], [-82.31652233378264, 40.68087946794591], [-82.31712455511278, 40.68141308690595], [-82.31828949901066, 40.68049885120396], [-82.3184873758629, 40.67851467391296], [-82.31918827447556, 40.678056198197964], [-82.32060959868384, 40.67812996598469], [-82.32145004199523, 40.67875122880623], [-82.32028823868248, 40.679845499582974], [-82.32055182114634, 40.68119352126188], [-82.32161450933276, 40.68109134110279], [-82.32352352393214, 40.68188038686565], [-82.32365243484199, 40.682419397084864], [-82.32483562711113, 40.68240582402477], [-82.32558291842885, 40.684288770619766], [-82.32737384063867, 40.685079109490474], [-82.32855659290067, 40.685065503149886], [-82.32893501624098, 40.68623214313832], [-82.33202345538443, 40.68682705248864], [-82.33238760017758, 40.68727331901868], [-82.33391837817813, 40.6868951912264], [-82.33499420888789, 40.68742361298555], [-82.33970336442133, 40.686197689267544], [-82.34490517228578, 40.685957162455566], [-82.34622658398601, 40.68693271523252], [-82.34930659480503, 40.687076792611705], [-82.35118649772058, 40.686424295927026], [-82.35246794465759, 40.68541833354065], [-82.3535329515901, 40.68540585065588]]]}, "attributes": {"Q1": 0, "Q3": 0, "Q2": 0, "Q5": 0, "Q4": 0, "Q7": 0, "Q6": 0, "Q9": 0, "Q8": 0, "M30D10Y": 0, "WEIGHTED": 0, "HYDROID": 2, "numVert": 12009, "PROB_30DAY": 0, "CSL1085LFP": 3.01124993354, "QAH": 0, "LC11DEV": 0, "Q50": 0, "Shape_Area": 800455349.514, "Edited": 0, "FPS75": 0, "MaxSimpTol": 0.000269796613823, "FPS50": 0, "DESCRIPT": "W05040002", "MinSimpTol": 0.000269796613823, "RELATEDOID": " ", "LC92STOR": 3.03990703292, "Q11": 0, "FOREST": 0, "Q12": 0, "PK25": 11200, "PK10": 9310, "M7D10Y": 0, "Q10": 0, "PK2": 5470, "PK500": 17300, "PROB_1DAY": 0, "OBJECTID": 1, "PK5": 7740, "GLOBALWSHD": 1, "DRNAREA": 309.087660106, "DRAINID": 2, "M1D10Y": 0, "FID": 0, "FPS25": 0, "Shape_Leng": 208440.722266, "M90D10Y": 0, "STREAM_VAR": 0, "PROB_7DAY": 0, "NAME": "ags101", "LAT_CENT": 0, "PK100": 14100, "DESCRIPTIO": " ", "ORIG_FID": 1, "WarningMsg": " ", "HUCID": "05040002", "D80": 0, "QA": 0, "LC11IMP": 0, "PRECIP": 0, "OHREGA": 1, "OHREGC": 0, "PK50": 12600, "LONG_CENT": 0}}], "spatialReference": {"wkid": 4326, "latestWkid": 4326}}}], "Workspace": "oh20151104132849041000"}

        except:
             tb = traceback.format_exc()
             Results = {
                       "error": {"message": traceback.format_exc()}
                       }

        finally:
            print "Results="+json.dumps(Results) 

if __name__ == '__main__':
    FeaturesWrapper()

